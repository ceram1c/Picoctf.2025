# PIE TIME

![image](https://github.com/user-attachments/assets/0973a52e-d265-43d8-948e-45ba8532dcde)

source code: 

1. bài này cho ta biết địa chỉ hàm main, và ta cần nhập địa chỉ hàm `win` để di chuyển tới rồi đọc flag theo như scource code
2. sử dụng `objdump -d ./vuln | grep win` để đọc ra địa chỉ hàm win trong source `vuln`

# hash-only-1

![image](https://github.com/user-attachments/assets/ed3b8dda-5e34-40e2-b5d3-f6be1a7dbc20)

1. sau khi truy cập vào host vào chạy file sẽ như này 

![image](https://github.com/user-attachments/assets/cc941845-6d25-4f4d-86fa-5d698252d776)

2. do bài cho phép tải file về từ host, sau khi tải về cấp quyền và chạy file 

![image](https://github.com/user-attachments/assets/a0e189d9-6496-4d09-bc28-f8380ddc6409)

![image](https://github.com/user-attachments/assets/34b9570d-cc98-4229-8ab7-3aa7ee2b6aed)

3. sau khi thử kiểm tra `md5sum` tha thấy flaghasher thực thi lệnh `/bin/bash -c 'md5sum /root/flag.txt'` có nghĩa là flaghasher thực thi script `md5sum` để tính toán md5 hash của file nhưng không chỉ rõ đường dẫn gọi script
4. ta có thể tạo 1 script giả `md5sum` nhưng chạy lệnh `cat` flag

![image](https://github.com/user-attachments/assets/1c5acd33-bc95-4e32-94ab-6625f5863e96)

5. cần thêm 1 bước `export PATH=.:$PATH` để host tìm thấy `md5sum` giả trước

         $PATH là một biến môi trường trong Linux chứa danh sách các thư mục mà hệ thống tìm kiếm khi thực thi một lệnh
         . đại diện cho thư mục hiện tại.
         .:$PATH có nghĩa là thêm thư mục hiện tại vào đầu danh sách tìm kiếm.
         export đưa thư mục hiện tại `.` lên đầu danh sách của $PATH.

6. sau đó chạy để đọc flag.


# hash-only-2

![image](https://github.com/user-attachments/assets/a40e02cb-ab56-4402-a153-5f31607bf765)

1. yêu cầu của bài này tương tự với hash-only-1 nhưng khi nc vào host thì lại không thấy file `flaghasher` đâu
2. sử dụng `find / -type f -iname "flaghasher"` để tìm , thì ta không thể cd tới đường dẫn của file đó

![image](https://github.com/user-attachments/assets/722ca0ad-3f7c-46be-b533-a3212ad6f7df)

3. sau khi thử sử dụng các câu lệnh có `/` hay `cd` đề không thành công
4. `echo $SHELL` để kiểm tra shell của host thì thấy ta đang ở trong 1 shell bị hạn chế là `rbash`

            `rbash` là 1 phiên bản khác của bash thường được dùng để hạn chế, kiểm soát người dùng
5. việc của ta là thoát khỏi shell này
6. sử dụng lệnh `bash` để hệ thống sẽ mở một phiên `bash` , Shell `bash` này không còn bị hạn chế vì nó là một quá trình mới, không còn bị rbash kiểm soát.

![image](https://github.com/user-attachments/assets/0a251c09-b59d-4eba-80ba-7a727e6f3ba1)


7. sau đó cd tới thư mục chứ flaghasher và giải như `hash-only-1`








   
