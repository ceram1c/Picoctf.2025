# PIE TIME

<h3>ĐỀ BÀI: Can you try to get the flag? Beware we have PIE! Connect to the program with netcat:

$ nc rescued-float.picoctf.net 57867

The program's source code can be downloaded here. The binary can be downloaded here.</h3>

source code: https://github.com/ceram1c/Picoctf.2025/blob/bf5f94e3de89d803aa609d3df322a9aaff4d8fe4/Picofile/vuln.c

binary: https://github.com/ceram1c/Picoctf.2025/blob/bf5f94e3de89d803aa609d3df322a9aaff4d8fe4/Picofile/vuln 

**Phân tích**: bài này cho ta biết địa chỉ hàm main, và muốn di chuyển theo địa chỉ khác

![image](https://github.com/user-attachments/assets/c0b7fcb7-2ec6-4761-84a0-33a96747e947)


**hướng giải**: ta cần nhập địa chỉ hàm `win` để di chuyển tới rồi đọc flag theo như scource code

**Giải**:

sử dụng `objdump -d ./vuln | grep win` để đọc ra địa chỉ hàm win trong source `vuln`, sử dụng địa chỉ hàm win nhập vào host bài cho để nhận flag

![image](https://github.com/user-attachments/assets/287de7c7-8433-48ee-9052-f270363170b8)

![image](https://github.com/user-attachments/assets/b694c589-5327-4210-8653-ca26435bed06)


# hash-only-1

<h3>ĐỀ BÀI: Here is a binary that has enough privilege to read the content of the flag file but will only let you know its hash. If only it could just give you the actual content! Connect using ssh ctf-player@shape-facility.picoctf.net -p 61003 with the password, f3b61b38 and run the binary named "flaghasher". You can get a copy of the binary if you wish: scp -P 61003 ctf-player@shape-facility.picoctf.net:~/flaghasher .</h3>

**Phân tích**: truy cập vào host để chạy file `flaghasher`, có thể tải file từ host về để nghiên cứu file 

**hướng giải**: 

1.tìm hiểu file là gì sau khi truy cập vào host vào chạy file sẽ như này 

![image](https://github.com/user-attachments/assets/cc941845-6d25-4f4d-86fa-5d698252d776)

2. do bài cho phép tải file về từ host, sau khi tải về cấp quyền và chạy file 

![image](https://github.com/user-attachments/assets/a0e189d9-6496-4d09-bc28-f8380ddc6409)

![image](https://github.com/user-attachments/assets/34b9570d-cc98-4229-8ab7-3aa7ee2b6aed)

3. sau khi thử kiểm tra `md5sum` tha thấy flaghasher thực thi lệnh `/bin/bash -c 'md5sum /root/flag.txt'` có nghĩa là flaghasher thực thi script `md5sum` để tính toán md5 hash của file nhưng không chỉ rõ đường dẫn gọi script

**Giải**:

1. ta tạo 1 script giả `md5sum` nhưng chạy lệnh `cat` flag

![image](https://github.com/user-attachments/assets/1c5acd33-bc95-4e32-94ab-6625f5863e96)

2. cần thêm 1 bước `export PATH=.:$PATH` để host tìm thấy `md5sum` giả trước

         $PATH là một biến môi trường trong Linux chứa danh sách các thư mục mà hệ thống tìm kiếm khi thực thi một lệnh
         . đại diện cho thư mục hiện tại.
         .:$PATH có nghĩa là thêm thư mục hiện tại vào đầu danh sách tìm kiếm.
         export đưa thư mục hiện tại `.` lên đầu danh sách của $PATH.

3. sau đó chạy để đọc flag.

![image](https://github.com/user-attachments/assets/9eb9aebc-f1a8-4197-ae06-1c0aaa2c8e04)


# hash-only-2

<h3>ĐỀ BÀI: Here is a binary that has enough privilege to read the content of the flag file but will only let you know its hash. If only it could just give you the actual content! Connect using ssh ctf-player@rescued-float.picoctf.net -p 51411 with the password, 84b12bae and run the binary named "flaghasher".</h3>

**Phân tích**:

1.yêu cầu của bài này tương tự với hash-only-1 nhưng khi nc vào host thì lại không thấy file `flaghasher` đâu
2. sử dụng `find / -type f -iname "flaghasher"` để tìm , thì ta không thể cd tới đường dẫn của file đó

![image](https://github.com/user-attachments/assets/722ca0ad-3f7c-46be-b533-a3212ad6f7df)

3. sau khi thử sử dụng các câu lệnh có `/` hay `cd` đề không thành công
4. `echo $SHELL` để kiểm tra shell của host thì thấy ta đang ở trong 1 shell bị hạn chế là `rbash`

            `rbash` là 1 phiên bản khác của bash thường được dùng để hạn chế, kiểm soát người dùng

**hướng giải**: ta cần thoát khỏi shell này để không bị hạn chế của rbash

**Giải**:

1. sử dụng lệnh `bash` để hệ thống sẽ mở một phiên `bash` , Shell `bash` này không còn bị hạn chế vì nó là một quá trình mới, không còn bị rbash kiểm soát.

![image](https://github.com/user-attachments/assets/0a251c09-b59d-4eba-80ba-7a727e6f3ba1)

2. sau đó cd tới thư mục chứ flaghasher và giải như `hash-only-1`

![image](https://github.com/user-attachments/assets/276f0021-4326-4d6a-beca-5e05e6e2c927)








   
